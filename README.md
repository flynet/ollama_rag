# RAG –°–∏—Å—Ç–µ–º–∞ —Å GUI –¥–ª—è –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ü–æ–∏—Å–∫–∞

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è RAG (Retrieval-Augmented Generation) —Å–∏—Å—Ç–µ–º–∞ –Ω–∞ –±–∞–∑–µ Docker —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º –∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–º –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å LLM.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è** –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏–∑ –ø–∞–ø–∫–∏ —Å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ **GPU-—É—Å–∫–æ—Ä–µ–Ω–∏–µ** –¥–ª—è embeddings (NVIDIA CUDA)
- ‚úÖ **Semantic Search API** –¥–ª—è –ø–æ–∏—Å–∫–∞ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ **Web GUI** (Open WebUI) –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å LLM
- ‚úÖ **RAG Middleware** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- ‚úÖ **Sentence Transformers** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π Gemma –º–æ–¥–µ–ª–µ–π
- ‚úÖ **Qdrant** –≤–µ–∫—Ç–æ—Ä–Ω–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
.
‚îú‚îÄ‚îÄ docker-compose.yaml          # –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ documents/               # üìÇ –°—é–¥–∞ –ø–æ–º–µ—â–∞–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îî‚îÄ‚îÄ gemma-2-2b-it/          # ü§ñ Gemma –º–æ–¥–µ–ª—å –¥–ª—è embeddings
‚îú‚îÄ‚îÄ embedder/                    # üìù –°–µ—Ä–≤–∏—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # Watcher + worker –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ embedder.py              # SentenceTransformer wrapper
‚îÇ   ‚îú‚îÄ‚îÄ vector_db.py             # Qdrant client wrapper
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ rag_api/                     # üîç API –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # FastAPI —Å–µ—Ä–≤–µ—Ä —Å endpoints
‚îÇ   ‚îú‚îÄ‚îÄ embedder.py              # Embedder –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ rag_middleware/              # üîÑ Middleware –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ RAG + LLM
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îú‚îÄ‚îÄ main.py                  # Proxy –º–µ–∂–¥—É WebUI –∏ Ollama + RAG
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ qdrant_data/                 # üíæ –í–µ–∫—Ç–æ—Ä–Ω–∞—è –ë–î (—Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
‚îú‚îÄ‚îÄ ollama_data/                 # ü§ñ –ú–æ–¥–µ–ª–∏ Ollama
‚îî‚îÄ‚îÄ webui_data/                  # üåê –î–∞–Ω–Ω—ã–µ Open WebUI
```

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   User      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Open WebUI     ‚îÇ (localhost:3000)
‚îÇ  Chat Interface ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
         ‚îÇ
         v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ RAG Middleware   ‚îÇ (localhost:8001)
‚îÇ ‚Ä¢ –ü–æ–ª—É—á–∞–µ—Ç –≤–æ–ø—Ä–æ—Å‚îÇ
‚îÇ ‚Ä¢ –ò—â–µ—Ç –≤ RAG API ‚îÇ
‚îÇ ‚Ä¢ –î–æ–±–∞–≤–ª—è–µ—Ç      ‚îÇ
‚îÇ   –∫–æ–Ω—Ç–µ–∫—Å—Ç       ‚îÇ
‚îÇ ‚Ä¢ –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤   ‚îÇ
‚îÇ   Ollama         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ       ‚îÇ
     v       v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇRAG API ‚îÇ ‚îÇ Ollama ‚îÇ
‚îÇ(search)‚îÇ ‚îÇ  LLM   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
     ‚îÇ
     v
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Qdrant    ‚îÇ‚óÑ‚îÄ‚îÄ‚îÄ‚îÄ‚îÇ  Embedder    ‚îÇ
‚îÇ Vector DB   ‚îÇ     ‚îÇ (Auto-Index) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           v
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ data/        ‚îÇ
                    ‚îÇ documents/   ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üê≥ –°–µ—Ä–≤–∏—Å—ã Docker

### 1. **Qdrant** (Vector Database)
- **–ü–æ—Ä—Ç**: `6333`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –•—Ä–∞–Ω–∏—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–î–∞–Ω–Ω—ã–µ**: `./qdrant_data`
- **Dashboard**: http://localhost:6333/dashboard

### 2. **Embedder** (Indexing Service)
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç `./data/documents` (polling –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
  - –°–æ–∑–¥–∞–µ—Ç embeddings —á–µ—Ä–µ–∑ SentenceTransformers
  - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ Qdrant
  - –ü–µ—Ä–µ–∏–Ω–¥–µ–∫—Å–∏—Ä—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **GPU**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç CUDA –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è
- **–ú–æ–¥–µ–ª—å**: Gemma 2-2B IT

### 3. **RAG API** (Search Service)
- **–ü–æ—Ä—Ç**: `8000`
- **Endpoints**:
  - `POST /search` - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫ –ø–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º
  - `GET /collection/info` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
  - `GET /collection/sample` - –ü—Ä–∏–º–µ—Ä—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
  - `GET /health` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- **Swagger**: http://localhost:8000/docs

### 4. **Ollama** (LLM Engine)
- **–ü–æ—Ä—Ç**: `11434`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –õ–æ–∫–∞–ª—å–Ω—ã–π inference –¥–ª—è LLM –º–æ–¥–µ–ª–µ–π
- **GPU**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç CUDA
- **–ú–æ–¥–µ–ª–∏**: –°–∫–∞—á–∏–≤–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é

### 5. **RAG Middleware**
- **–ü–æ—Ä—Ç**: `8001`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –°–≤—è–∑—ã–≤–∞–µ—Ç Open WebUI —Å RAG API –∏ Ollama
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ü–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –≤–æ–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  - –î–µ–ª–∞–µ—Ç –ø–æ–∏—Å–∫ –≤ RAG API
  - –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–∞–π–¥–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤ –ø—Ä–æ–º–ø—Ç
  - –ü—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –∫ Ollama
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
  - `RAG_TOP_K=3` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
  - `ENABLE_RAG=true` - –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å RAG

### 6. **Open WebUI** (Chat Interface)
- **–ü–æ—Ä—Ç**: `3000`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ**: –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å LLM
- **–§—É–Ω–∫—Ü–∏–∏**:
  - –ö—Ä–∞—Å–∏–≤—ã–π —á–∞—Ç-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (–∫–∞–∫ ChatGPT)
  - –ò—Å—Ç–æ—Ä–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤
  - –í—ã–±–æ—Ä –º–æ–¥–µ–ª–µ–π
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
- **URL**: http://localhost:3000

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **Docker –∏ Docker Compose**
2. **NVIDIA GPU** —Å CUDA 12.4+
3. **NVIDIA Container Toolkit**
4. **Gemma –º–æ–¥–µ–ª—å** –¥–ª—è embeddings (—Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–ª–∏ –≤—Ä—É—á–Ω—É—é)

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

**1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ –ø—Ä–æ–µ–∫—Ç –∏ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:**
```bash
cd D:\Docker\RAG
```

**2. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –º–æ–¥–µ–ª—å Gemma (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ - —Å–∫–∞—á–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏):**

–ú–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Å–∫–∞—á–∞–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∏–∑ HuggingFace.

**3. –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏:**
```bash
mkdir -p data/documents
```

**4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã:**
```bash
docker-compose up -d --build
```

**5. –°–∫–∞—á–∞–π—Ç–µ LLM –º–æ–¥–µ–ª—å –¥–ª—è Ollama:**
```bash
# Gemma 2B (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
docker exec -it ollama ollama pull gemma2:2b

# –ò–ª–∏ Llama 3.2
docker exec -it ollama ollama pull llama3.2:3b

# –ò–ª–∏ Qwen 2.5
docker exec -it ollama ollama pull qwen2.5:3b
```

**6. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**

–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ: **http://localhost:3000**

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—Ö–æ–¥–µ —Å–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç (–¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ).

## üìñ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### 1Ô∏è‚É£ –ò–Ω–¥–µ–∫—Å–∞—Ü–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–ø–∫—É `data/documents`:

```bash
# Windows PowerShell
Copy-Item .\mydocument.txt .\data\documents\

# Linux/WSL
cp mydocument.txt ./data/documents/
```

**Embedder –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –û–±–Ω–∞—Ä—É–∂–∏—Ç –Ω–æ–≤—ã–π —Ñ–∞–π–ª (—á–µ—Ä–µ–∑ ~1 —Å–µ–∫—É–Ω–¥—É)
- –†–∞–∑–æ–±—å–µ—Ç –Ω–∞ chunks
- –°–æ–∑–¥–∞—Å—Ç embeddings
- –°–æ—Ö—Ä–∞–Ω–∏—Ç –≤ Qdrant

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:**
```bash
docker-compose logs -f embedder
```

–í—ã —É–≤–∏–¥–∏—Ç–µ:
```
[WATCHER] Stable event for /data/documents/mydocument.txt
[WORKER] Got task: modified -> /data/documents/mydocument.txt
[WORKER] Upserted 5 chunks for /data/documents/mydocument.txt
```

### 2Ô∏è‚É£ –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ API

**–°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫:**
```bash
curl -X POST http://localhost:8000/search \
  -H "Content-Type: application/json" \
  -d '{"query": "–ö—Ç–æ —Ç–∞–∫–æ–π –ü—É–ø–∫–∏–Ω", "top_k": 5}'
```

**PowerShell:**
```powershell
$body = @{
    query = "–ö—Ç–æ —Ç–∞–∫–æ–π –ü—É–ø–∫–∏–Ω"
    top_k = 5
} | ConvertTo-Json

Invoke-RestMethod -Uri http://localhost:8000/search -Method Post -Body $body -ContentType "application/json"
```

**–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:**
```json
[
  {
    "score": 0.98,
    "text": "–í–∞—Å—è –ü—É–ø–∫–∏ - —Ü–∞—Ä—å –≤—Å–µ—Ö –∑–≤–µ—Ä–µ–π.",
    "file": "/data/documents/example.txt",
    "chunk": 0
  }
]
```

**–î—Ä—É–≥–∏–µ endpoints:**
```bash
# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª–ª–µ–∫—Ü–∏–∏
curl http://localhost:8000/collection/info

# –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
curl http://localhost:8000/collection/sample?limit=10

# –ó–¥–æ—Ä–æ–≤—å–µ API
curl http://localhost:8000/health
```

### 3Ô∏è‚É£ –û–±—â–µ–Ω–∏–µ —Å LLM —á–µ—Ä–µ–∑ WebUI

**1. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä:** http://localhost:3000

**2. –°–æ–∑–¥–∞–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç** (–ø–µ—Ä–≤—ã–π –≤—Ö–æ–¥)

**3. –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å** –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞

**4. –ù–∞—á–Ω–∏—Ç–µ –¥–∏–∞–ª–æ–≥!**

**RAG —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:**
- –í—ã –∑–∞–¥–∞–µ—Ç–µ –≤–æ–ø—Ä–æ—Å
- Middleware –∏—â–µ—Ç —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- –î–æ–±–∞–≤–ª—è–µ—Ç –∏—Ö –∫–∞–∫ –∫–æ–Ω—Ç–µ–∫—Å—Ç
- LLM –æ—Ç–≤–µ—á–∞–µ—Ç —Å —É—á–µ—Ç–æ–º –≤–∞—à–µ–π –±–∞–∑—ã –∑–Ω–∞–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã: –ö—Ç–æ —Ç–∞–∫–æ–π –ü—É–ø–∫–∏–Ω?

[–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Ö–æ–¥–∏—Ç –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö: "–í–∞—Å—è –ü—É–ø–∫–∏ - —Ü–∞—Ä—å –≤—Å–µ—Ö –∑–≤–µ—Ä–µ–π"]

LLM: –ù–∞ –æ—Å–Ω–æ–≤–µ –∏–º–µ—é—â–µ–π—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏, –í–∞—Å—è –ü—É–ø–∫–∏–Ω - —ç—Ç–æ —Ü–∞—Ä—å –≤—Å–µ—Ö –∑–≤–µ—Ä–µ–π. 
–≠—Ç–æ —É–ø–æ–º–∏–Ω–∞–µ—Ç—Å—è –≤ –≤–∞—à–∏—Ö –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö.
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ docker-compose.yaml

**Embedder:**
```yaml
- MODEL_PATH=/models/gemma-2-2b-it  # –ü—É—Ç—å –∫ –º–æ–¥–µ–ª–∏
- WATCH_PATH=/data/documents         # –ü–∞–ø–∫–∞ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- DEBOUNCE_SEC=1.0                   # –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–µ–π
- CHUNK_SIZE=1024                    # –†–∞–∑–º–µ—Ä chunk (—Å–∏–º–≤–æ–ª–æ–≤)
- CHUNK_OVERLAP=128                  # Overlap –º–µ–∂–¥—É chunks
```

**RAG API:**
```yaml
- MODEL_PATH=/models/gemma-2-2b-it
- QDRANT_HOST=qdrant
- QDRANT_PORT=6333
- COLLECTION_NAME=documents
```

**RAG Middleware:**
```yaml
- RAG_TOP_K=3           # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ
- ENABLE_RAG=true       # –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å RAG
- OLLAMA_BASE_URL=http://ollama:11434
- RAG_API_URL=http://rag-api:8000
```

### –°–º–µ–Ω–∞ –º–æ–¥–µ–ª–∏ embeddings

–í `docker-compose.yaml` –∏–∑–º–µ–Ω–∏—Ç–µ `MODEL_PATH` –Ω–∞ –¥—Ä—É–≥—É—é HuggingFace –º–æ–¥–µ–ª—å:

```yaml
- MODEL_PATH=google/gemma-2-2b-it              # –¢–µ–∫—É—â–∞—è
- MODEL_PATH=sentence-transformers/all-MiniLM-L6-v2  # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞
```

## üêõ Troubleshooting

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è

```bash
# –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker-compose ps

# –õ–æ–≥–∏ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose logs

# –õ–æ–≥–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose logs -f embedder
docker-compose logs -f rag-api
docker-compose logs -f qdrant
```

### Qdrant –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π

–ï—Å–ª–∏ Qdrant –∫—Ä–∞—à–∏—Ç—Å—è, –æ—á–∏—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ:
```bash
docker-compose down
Remove-Item -Path .\qdrant_data\* -Recurse -Force
docker-compose up -d
```

### –ú–æ–¥–µ–ª—å –Ω–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø –∫ HuggingFace –∏ –Ω–∞–ª–∏—á–∏–µ –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ:
```bash
docker-compose logs embedder | Select-String "Loading model"
```

### –î–æ–∫—É–º–µ–Ω—Ç—ã –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ embedder
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Ñ–∞–π–ª—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –ø–∞–ø–∫–µ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ embedder –∑–∞–ø—É—â–µ–Ω

### WebUI –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ –º–æ–¥–µ–ª—è–º

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ Ollama —Ä–∞–±–æ—Ç–∞–µ—Ç
curl http://localhost:11434/api/tags

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ middleware
curl http://localhost:8001/health
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**Qdrant Dashboard:**
- URL: http://localhost:6333/dashboard
- –ü—Ä–æ—Å–º–æ—Ç—Ä –∫–æ–ª–ª–µ–∫—Ü–∏–π, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

**RAG API Swagger:**
- URL: http://localhost:8000/docs
- –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API

**–õ–æ–≥–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏:**
```bash
docker-compose logs -f
```

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–¥–∞

**embedder/main.py** - –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ—Ü–µ—Å—Å –∏–Ω–¥–µ–∫—Å–∞—Ü–∏–∏:
- `DebounceHandler` - Watchdog handler —Å debounce
- `ingestion_worker` - Async worker –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ñ–∞–π–ª–æ–≤
- `main()` - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫

**rag_api/main.py** - FastAPI endpoints:
- `/search` - –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–∏—Å–∫
- `/collection/info` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `/collection/sample` - –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö

**rag_middleware/main.py** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è RAG + LLM:
- `get_rag_context()` - –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∏–∑ RAG
- `/api/chat` - Proxy —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- `/api/tags` - –°–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π

### –ó–∞–ø—É—Å–∫ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
# –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
docker-compose up -d --build

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
docker-compose restart embedder
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞

```bash
echo "–í–∞—Å—è –ü—É–ø–∫–∏–Ω - —ç—Ç–æ –≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π –Ω–∞—à–µ–π –∏—Å—Ç–æ—Ä–∏–∏." > ./data/documents/story.txt
```

### –ü–æ–∏—Å–∫ —á–µ—Ä–µ–∑ curl

```bash
curl -X POST http://localhost:8000/search \
  -H "Content-Type: application/json" \
  -d '{"query": "–≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π", "top_k": 3}' | jq
```

### Python –∫–ª–∏–µ–Ω—Ç

```python
import requests

response = requests.post(
    "http://localhost:8000/search",
    json={"query": "–≥–ª–∞–≤–Ω—ã–π –≥–µ—Ä–æ–π", "top_k": 3}
)

results = response.json()
for result in results:
    print(f"Score: {result['score']}")
    print(f"Text: {result['text']}")
    print(f"File: {result['file']}")
    print("---")
```

## üöÄ Production

–î–ª—è production –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

1. **–ò–∑–º–µ–Ω–∏—Ç–µ `WEBUI_SECRET_KEY`** –≤ docker-compose.yaml
2. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ firewall** –¥–ª—è –ø–æ—Ä—Ç–æ–≤
3. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ reverse proxy** (nginx/traefik)
4. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ backup** –¥–ª—è `qdrant_data` –∏ `webui_data`
5. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** —á–µ—Ä–µ–∑ Prometheus/Grafana

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [Qdrant Documentation](https://qdrant.tech/documentation/)
- [Ollama Models](https://ollama.com/library)
- [Open WebUI](https://github.com/open-webui/open-webui)
- [Sentence Transformers](https://www.sbert.net/)

## üìÑ –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## ü§ù –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker-compose logs`
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ GPU –¥–æ—Å—Ç—É–ø–µ–Ω: `nvidia-smi`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏–∏ Docker –∏ CUDA
